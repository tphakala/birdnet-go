import{c as We,A as Ga}from"./index.js";import{p as Aa,a as K,k as m,i as h,g as e,e as Oa,l as a,h as d,j as Ua,y as je,Q as Ie,S as Ka,s as k,b as He,u as Ya,n as s,o as t,t as B,q as pa,r as Y,B as x,c as Va,f as fa,L as $a,w as b,T as Pe,R as Ra,x as I,E as et,d as at,C as tt}from"./vendor.js";import{C as it}from"./CollapsibleSection.js";import{f as rt}from"./api.js";var nt=je('<svg><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>'),st=je('<svg><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg>'),ot=je('<svg><path d="M17 18a5 5 0 0 0-10 0"></path><line x1="12" y1="2" x2="12" y2="9"></line><line x1="4.22" y1="10.22" x2="5.64" y2="11.64"></line><line x1="1" y1="18" x2="3" y2="18"></line><line x1="21" y1="18" x2="23" y2="18"></line><line x1="18.36" y1="11.64" x2="19.78" y2="10.22"></line><line x1="23" y1="22" x2="1" y2="22"></line><polyline points="8 6 12 2 16 6"></polyline></svg>'),lt=je('<svg><path d="M17 18a5 5 0 0 0-10 0"></path><line x1="12" y1="9" x2="12" y2="2"></line><line x1="4.22" y1="10.22" x2="5.64" y2="11.64"></line><line x1="1" y1="18" x2="3" y2="18"></line><line x1="21" y1="18" x2="23" y2="18"></line><line x1="18.36" y1="11.64" x2="19.78" y2="10.22"></line><line x1="23" y1="22" x2="1" y2="22"></line><polyline points="16 5 12 9 8 5"></polyline></svg>'),dt=je('<svg><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>'),vt=m('<div class="inline-flex items-center"><!></div>');function ct(c,r){Aa(r,!0);let v=K(r,"size",3,"md"),M=K(r,"showTooltip",3,!1),f=K(r,"className",3,""),T=Ka(r,["$$slots","$$events","$$legacy","datetime","timeOfDay","size","showTooltip","className"]);function P(y){if(!y)return"day";const j=y instanceof Date?y:new Date(y),C=j.getHours(),de=j.getMinutes(),_=C*60+de;return _>=360&&_<420?"dawn":_>=420&&_<480?"sunrise":_>=480&&_<1020?"day":_>=1020&&_<1080?"sunset":_>=1080&&_<1140?"dusk":"night"}let S=Oa(()=>r.timeOfDay||P(r.datetime));const p={sm:"h-4 w-4",md:"h-5 w-5",lg:"h-6 w-6",xl:"h-8 w-8"},H={day:"text-yellow-500",night:"text-indigo-500",sunrise:"text-orange-500",sunset:"text-red-500",dawn:"text-orange-400",dusk:"text-purple-500"},w={day:"Daytime",night:"Nighttime",sunrise:"Sunrise",sunset:"Sunset",dawn:"Dawn",dusk:"Dusk"};let q=Oa(()=>We(p[v()],H[e(S)],f())),O=Oa(()=>e(S)==="dawn"?"sunrise":e(S)==="dusk"?"sunset":e(S));var R=vt(),oe=a(R);{var le=y=>{var j=nt();Ie(j,()=>({xmlns:"http://www.w3.org/2000/svg",class:e(q),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",title:M()?w[e(S)]:void 0,...T})),d(y,j)},W=(y,j)=>{{var C=_=>{var $=st();Ie($,()=>({xmlns:"http://www.w3.org/2000/svg",class:e(q),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",title:M()?w[e(S)]:void 0,...T})),d(_,$)},de=(_,$)=>{{var _e=u=>{var g=ot();Ie(g,()=>({xmlns:"http://www.w3.org/2000/svg",class:e(q),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round","aria-hidden":"true",title:M()?w[e(S)]:void 0,...T})),d(u,g)},o=(u,g)=>{{var he=F=>{var A=lt();Ie(A,()=>({xmlns:"http://www.w3.org/2000/svg",class:e(q),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round","aria-hidden":"true",title:M()?w[e(S)]:void 0,...T})),d(F,A)},U=F=>{var A=dt();Ie(A,ee=>({xmlns:"http://www.w3.org/2000/svg",class:ee,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",title:M()?"Unknown time":void 0,...T}),[()=>We(p[v()],"text-gray-400",f())]),d(F,A)};h(u,F=>{e(O)==="sunset"?F(he):F(U,!1)},g)}};h(_,u=>{e(O)==="sunrise"?u(_e):u(o,!1)},$)}};h(y,_=>{e(O)==="night"?_(C):_(de,!1)},j)}};h(oe,y=>{e(O)==="day"?y(le):y(W,!1)})}d(c,R),Ua()}var ut=m("<h3>Weather Information</h3>"),pt=m('<div class="py-4 flex justify-center" role="status" aria-live="polite"><span class="loading loading-spinner loading-md text-primary"></span> <span class="sr-only">Loading weather information...</span></div>'),ft=m('<div class="py-4" role="alert"><div class="text-error flex items-center"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg> <span> </span></div></div>'),mt=m('<div class="flex items-center"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-blue-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg> <div><div class="text-base-content/70">Pressure</div> <div class="font-medium"> </div></div></div>'),_t=m('<div class="flex items-center"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-blue-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z"></path></svg> <div><div class="text-base-content/70">Cloud Cover</div> <div class="font-medium"> </div></div></div>'),ht=m('<div aria-live="polite"><div class="flex items-center"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-blue-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z"></path></svg> <div><div class="text-base-content/70">Temperature</div> <div class="font-medium"> </div></div></div> <div class="flex items-center"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-blue-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg> <div><div class="text-base-content/70">Weather</div> <div class="font-medium"> </div></div></div> <div class="flex items-center"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-blue-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"></path></svg> <div><div class="text-base-content/70">Wind</div> <div class="font-medium"> </div></div></div> <div class="flex items-center"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-blue-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <div><div class="text-base-content/70">Humidity</div> <div class="font-medium"> </div></div></div> <!> <!></div>'),gt=m('<div class="py-4 text-center text-base-content/50">No weather data available</div>'),bt=m("<div><!> <!></div>");function wt(c,r){Aa(r,!0);let v=K(r,"compact",3,!1),M=K(r,"showTitle",3,!0),f=K(r,"autoFetch",3,!0),T=K(r,"className",3,""),P=K(r,"titleClassName",3,""),S=K(r,"gridClassName",3,""),p=k(He(r.weatherData||null)),H=k(!1),w=k(null);async function q(o){if(o){s(H,!0),s(w,null);try{const u=await rt(`/api/v2/weather/detection/${o}`);if(!u.ok)throw new Error("Weather data not available");const g=await u.json();s(p,g,!0),r.onLoad?.(g)}catch(u){const g=u instanceof Error?u.message:"Failed to load weather data";s(w,g,!0),r.onError?.(u instanceof Error?u:new Error(g))}finally{s(H,!1)}}}function O(o){return o===void 0?"N/A":`${o}°C`}function R(o){return o===void 0?"N/A":`${o}%`}function oe(o){return o===void 0?"N/A":`${o} km/h`}let le=k(void 0);Ya(()=>{r.detectionId&&f()&&r.detectionId!==e(le)&&(s(le,r.detectionId,!0),q(r.detectionId))});function W(){r.detectionId&&q(r.detectionId)}function y(o){s(p,o,!0),s(w,null),s(H,!1)}var j=bt(),C=a(j);{var de=o=>{var u=ut();B(g=>Y(u,1,g),[()=>pa(We("text-lg font-semibold text-base-content mb-3",P()))]),d(o,u)};h(C,o=>{M()&&o(de)})}var _=t(C,2);{var $=o=>{var u=pt();d(o,u)},_e=(o,u)=>{{var g=U=>{var F=ft(),A=a(F),ee=t(a(A),2),E=a(ee);B(()=>x(E,e(w))),d(U,F)},he=(U,F)=>{{var A=E=>{var ve=Va(),ge=fa(ve);{var Je=ae=>{var te=Va(),ce=fa(te);$a(ce,()=>r.children,()=>e(p)),d(ae,te)},ma=ae=>{var te=ht(),ce=a(te),be=t(a(ce),2),Qe=t(a(be),2),Xe=a(Qe),Ze=t(ce,2),_a=t(a(Ze),2),ha=t(a(_a),2),Ge=a(ha),Ke=t(Ze,2),Ye=t(a(Ke),2),$e=t(a(Ye),2),ga=a($e),ea=t(Ke,2),ba=t(a(ea),2),wa=t(a(ba),2),xa=a(wa),De=t(ea,2);{var ya=L=>{var J=mt(),ue=t(a(J),2),ie=t(a(ue),2),qe=a(ie);B(()=>x(qe,`${e(p).hourly.pressure??""} hPa`)),d(L,J)};h(De,L=>{!v()&&e(p).hourly?.pressure!==void 0&&L(ya)})}var ka=t(De,2);{var aa=L=>{var J=_t(),ue=t(a(J),2),ie=t(a(ue),2),qe=a(ie);B(ta=>x(qe,ta),[()=>R(e(p).hourly.clouds)]),d(L,J)};h(ka,L=>{!v()&&e(p).hourly?.clouds!==void 0&&L(aa)})}B((L,J,ue,ie)=>{Y(te,1,L),x(Xe,J),x(Ge,e(p).hourly?.weatherMain||"N/A"),x(ga,ue),x(xa,ie)},[()=>pa(We("grid gap-2 text-sm",v()?"grid-cols-2 sm:grid-cols-4":"grid-cols-2",S())),()=>O(e(p).hourly?.temperature),()=>oe(e(p).hourly?.windSpeed),()=>R(e(p).hourly?.humidity)]),d(ae,te)};h(ge,ae=>{r.children?ae(Je):ae(ma,!1)})}d(E,ve)},ee=E=>{var ve=gt();d(E,ve)};h(U,E=>{e(p)?E(A):E(ee,!1)},F)}};h(o,U=>{e(w)?U(g):U(he,!1)},u)}};h(_,o=>{e(H)?o($):o(_e,!1)})}return B(o=>Y(j,1,o),[()=>pa(We("weather-info",T()))]),d(c,j),Ua({refresh:W,setWeatherData:y})}function xt(c,r,v,M,f,T,P,S,p,H,w){s(r,""),v.start="",v.end="",M.min=0,M.max=100,s(f,"any"),s(T,"any"),s(P,"any"),s(S,!1),s(p,[],!0),s(H,""),s(w,{},!0)}var yt=m('<div class="tooltip svelte-1mlqqt2" id="speciesTooltip" role="tooltip">Enter full or partial species name (not case sensitive)</div>'),kt=m('<div class="tooltip svelte-1mlqqt2" id="dateRangeTooltip" role="tooltip">Filter detections by date range (leave empty for all dates)</div>'),Mt=m('<div class="text-error text-sm mt-1" role="alert"> </div>'),St=m('<div class="form-control"><label class="label" for="confidenceMin"><span class="label-text">Confidence Range (%)</span> <span class="label-text-alt"> </span></label> <div class="gap-6 search-confidence-grid svelte-1mlqqt2" role="group" aria-labelledby="confidenceRangeLabel"><div><input type="range" min="0" max="100" id="confidenceMin" class="range range-xs" aria-label="Minimum confidence percentage" aria-valuemin="0" aria-valuemax="100"/> <div class="flex justify-between text-xs px-2"><span>0%</span> <span> </span></div></div> <div><input type="range" min="0" max="100" class="range range-xs" aria-label="Maximum confidence percentage" aria-valuemin="0" aria-valuemax="100"/> <div class="flex justify-between text-xs px-2"><span>0%</span> <span> </span></div></div></div> <!></div> <div class="gap-6 search-filters-grid svelte-1mlqqt2"><div class="form-control"><label class="label" for="verifiedStatusFilter"><span class="label-text">Verified Status</span></label> <select id="verifiedStatusFilter" class="select select-bordered w-full"><option>Any Status</option><option>Verified Only</option><option>Unverified Only</option></select></div> <div class="form-control"><label class="label" for="lockedStatusFilter"><span class="label-text">Locked Status</span></label> <select id="lockedStatusFilter" class="select select-bordered w-full"><option>Any Status</option><option>Locked Only</option><option>Unlocked Only</option></select></div> <div class="form-control"><label class="label" for="timeOfDayFilter"><span class="label-text">Time of Day</span></label> <select id="timeOfDayFilter" class="select select-bordered w-full"><option>Any Time</option><option>Day Only</option><option>Night Only</option><option>Sunrise +/- 30min</option><option>Sunset +/- 30min</option></select></div></div>',1),Ct=m('<span class="loading loading-spinner loading-sm mr-2" aria-hidden="true"></span>'),jt=je('<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd"></path></svg>'),Dt=(c,r)=>r("date_desc"),qt=(c,r)=>r("date_asc"),Nt=(c,r)=>r("species_asc"),zt=(c,r)=>r("confidence_desc"),Tt=m('<div class="flex items-center gap-4"><span class="text-sm text-base-content/70" aria-live="polite"> </span> <div class="dropdown dropdown-end"><div tabindex="0" role="button" class="btn btn-sm btn-outline" aria-haspopup="true" aria-expanded="false" aria-label="Sort results"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" viewBox="0 0 20 20" aria-hidden="true" stroke="currentColor"><path d="M5 4a1 1 0 00-2 0v7.268a2 2 0 000 3.464V16a1 1 0 102 0v-1.268a2 2 0 000-3.464V4zM11 4a1 1 0 10-2 0v1.268a2 2 0 000 3.464V16a1 1 0 102 0V8.732a2 2 0 000-3.464V4zM16 3a1 1 0 011 1v7.268a2 2 0 010 3.464V16a1 1 0 11-2 0v-1.268a2 2 0 010-3.464V4a1 1 0 011-1z"></path></svg> Sort</div> <ul tabindex="0" class="dropdown-content z-[1] menu p-2 shadow bg-base-100 rounded-box w-52" role="menu"><li role="menuitem"><button type="button" class="btn btn-ghost btn-sm justify-start w-full">Date (Newest First)</button></li> <li role="menuitem"><button type="button" class="btn btn-ghost btn-sm justify-start w-full">Date (Oldest First)</button></li> <li role="menuitem"><button type="button" class="btn btn-ghost btn-sm justify-start w-full">Species (A-Z)</button></li> <li role="menuitem"><button type="button" class="btn btn-ghost btn-sm justify-start w-full">Confidence (High-Low)</button></li></ul></div></div>'),Bt=m('<div class="alert alert-error mt-4" role="alert"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span> </span></div>'),Ft=m('<div class="mt-6 bg-base-200 rounded-lg p-4 flex flex-col items-center justify-center min-h-[200px]" aria-labelledby="search-results-heading"><svg xmlns="http://www.w3.org/2000/svg" class="w-16 h-16 text-base-content/30" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"></path></svg> <p class="text-base-content/50 text-center mt-4">No search performed yet</p> <p class="text-base-content/50 text-center text-sm">Use the search filters above to find bird detections</p></div>'),Ot=m('<div class="mt-6 bg-base-200 rounded-lg p-4 flex flex-col items-center justify-center min-h-[200px]" aria-live="polite" aria-busy="true"><span class="loading loading-spinner loading-lg text-primary" aria-hidden="true"></span> <p class="text-base-content/50 text-center mt-4">Loading results...</p></div>'),Rt=(c,r,v)=>r(e(v).id),At=(c,r,v)=>{(c.key==="Enter"||c.key===" ")&&(c.preventDefault(),r(e(v).id))},Ut=c=>{c.preventDefault()},Et=(c,r)=>window.location.href=`/api/v2/detections/${e(r).id}`,Lt=(c,r,v)=>{c.preventDefault(),r(e(v).id)},Vt=(c,r,v)=>r(e(v).id),It=(c,r,v)=>{(c.key==="Enter"||c.key===" ")&&(c.preventDefault(),r(e(v).id))},Pt=m('<tr class="expanded-row svelte-1mlqqt2"><td colspan="6" class="p-0 border-t-0 svelte-1mlqqt2"><div><div class="grid grid-cols-1 lg:grid-cols-3 gap-4"><div class="bg-base-200 rounded-box p-4"><!></div> <div class="bg-base-200 rounded-box p-4 flex flex-col justify-center items-center"><div class="w-full aspect-square rounded-md overflow-hidden bg-gray-100 cursor-pointer hover:brightness-90 transition-all focus:outline-none focus:ring-2 focus:ring-primary" role="button" tabindex="0" title="Click to collapse"><img class="w-full h-full object-cover" loading="lazy"/></div></div> <div class="bg-base-200 rounded-box p-4"><h3 class="text-lg font-semibold mb-2">Audio Player</h3> <!></div></div></div></td></tr>'),Ht=m('<tr><td> </td><td><div class="flex items-center"><!> <span> </span></div></td><td><div class="flex items-center gap-2"><div class="w-12 h-12 rounded-md overflow-hidden bg-gray-100 flex-shrink-0 cursor-pointer hover:ring-2 hover:ring-primary transition-all focus:outline-none focus:ring-2 focus:ring-primary" role="button" tabindex="0"><img class="w-full h-full object-cover" loading="lazy"/></div> <div><div class="font-bold"> </div> <div class="text-xs opacity-50"> </div></div></div></td><td><div class="flex items-center"><div class="flex items-center gap-2 w-full"><div class="w-16 h-4 rounded-full overflow-hidden bg-base-200" role="progressbar" aria-valuemin="0" aria-valuemax="100"><div></div></div> <span class="ml-1 font-semibold"> </span></div></div></td><td><div class="flex gap-1 flex-wrap"><div> </div> <div> </div></div></td><td><div class="flex gap-1"><button class="btn btn-xs btn-square" aria-pressed="false"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"></path></svg></button> <button class="btn btn-xs btn-square"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path></svg></button> <button class="btn btn-xs btn-square expand-btn"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button></div></td></tr> <!>',1),Wt=m('<div class="overflow-x-auto mt-4" aria-labelledby="search-results-heading"><table class="table w-full"><thead><tr><th scope="col">Date & Time</th><th scope="col">Time of Day</th><th scope="col">Species</th><th scope="col">Confidence</th><th scope="col">Status</th><th scope="col">Actions</th></tr></thead><tbody></tbody></table></div>'),Jt=m('<div class="mt-6 bg-base-200 rounded-lg p-4 flex flex-col items-center justify-center min-h-[200px]"><svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-base-content/30" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <p class="mt-2 text-base-content/70">No results found</p> <p class="text-sm text-base-content/50">Try adjusting your search filters</p></div>'),Qt=(c,r,v)=>r(e(v)-1),Xt=(c,r,v)=>r(e(v)+1),Zt=m('<div class="flex justify-center mt-6"><div class="join"><button class="join-item btn">«</button> <button class="join-item btn"> </button> <button class="join-item btn">»</button></div></div>'),Gt=m('<div class="col-span-12 space-y-4" role="region" aria-label="Bird Detection Search"><div class="card bg-base-100 shadow-sm"><div class="card-body card-padding svelte-1mlqqt2"><h2 class="card-title" id="search-filters-heading">Search Filters</h2> <form id="searchForm" class="space-y-4" aria-labelledby="search-filters-heading"><div class="gap-4 search-form-grid svelte-1mlqqt2"><div class="form-control"><label class="label" for="species"><span class="label-text">Species</span> <span class="help-icon svelte-1mlqqt2" role="button" tabindex="0" aria-label="Help for Species" aria-describedby="speciesTooltip">ⓘ</span></label> <input type="text" id="species" placeholder="Enter species name" class="input input-bordered w-full"/> <!></div> <div class="form-control"><label class="label" for="dateRangeStart"><span class="label-text">Date Range</span> <span class="help-icon svelte-1mlqqt2" role="button" tabindex="0" aria-label="Help for Date Range" aria-describedby="dateRangeTooltip">ⓘ</span></label> <div class="gap-2 search-date-grid svelte-1mlqqt2" role="group" aria-labelledby="dateRangeLabel"><input type="date" id="dateRangeStart" placeholder="Start Date" class="input input-bordered w-full" aria-label="From"/> <input type="date" id="endDate" placeholder="End Date" class="input input-bordered w-full" aria-label="To"/></div> <!></div></div> <!> <div class="flex flex-row gap-4 justify-end"><button type="button" class="btn btn-ghost flex-shrink-0" aria-label="Reset all search filters">Reset</button> <button type="submit" class="btn btn-primary flex-shrink-0" aria-label="Search for bird detections"><!> Search</button></div></form></div></div> <div class="card bg-base-100 shadow-sm"><div class="card-body card-padding svelte-1mlqqt2"><div class="flex items-center justify-between"><h2 class="card-title" id="search-results-heading">Search Results</h2> <!></div> <!> <!> <!> <!> <!> <!></div></div></div>');function ai(c,r){Aa(r,!0);let v=k(""),M=He({start:"",end:""}),f=He({min:0,max:100}),T=k("any"),P=k("any"),S=k("any"),p=k(!1),H=!1,w=k(!1),q=k(1),O=k(1),R=k(He([])),oe=k(0),le=k("date_desc"),W=k(""),y=k(He({})),j=k(""),C=k(null);function de(){return s(j,""),f.min>f.max?(s(j,"Minimum confidence cannot be greater than maximum confidence."),!1):!0}async function _(i=1){if(de()){s(w,!0),s(W,""),s(q,i,!0),s(y,{},!0);try{const l={species:e(v),dateStart:M.start,dateEnd:M.end,confidenceMin:f.min/100,confidenceMax:f.max/100,verifiedStatus:e(T),lockedStatus:e(P),timeOfDay:e(S),page:e(q),sortBy:e(le)},N=await fetch("/api/v2/search",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-Token":document.querySelector('meta[name="csrf-token"]')?.content||""},body:JSON.stringify(l)});if(!N.ok)throw new Error(`Server responded with ${N.status}`);const D=await N.json();s(R,D.results||[],!0),s(oe,D.total||0,!0),s(O,D.pages||1,!0),s(p,!0)}catch(l){s(W,`Search failed: ${l instanceof Error?l.message:"Unknown error"}`),s(R,[],!0)}finally{s(w,!1)}}}function $(i){return i?new Date(i).toLocaleString():""}function _e(i){i<1||i>e(O)||_(i)}function o(i){s(le,i,!0),_(1)}function u(i){s(y,{...e(y),[i]:!e(y)[i]},!0)}function g(i){return!!e(y)[i]}var he=Gt(),U=a(he),F=a(U),A=t(a(F),2),ee=a(A),E=a(ee),ve=a(E),ge=t(a(ve),2),Je=t(ve,2),ma=t(Je,2);{var ae=i=>{var l=yt();d(i,l)};h(ma,i=>{e(C)==="species"&&i(ae)})}var te=t(E,2),ce=a(te),be=t(a(ce),2),Qe=t(ce,2),Xe=a(Qe),Ze=t(Xe,2),_a=t(Qe,2);{var ha=i=>{var l=kt();d(i,l)};h(_a,i=>{e(C)==="dateRange"&&i(ha)})}var Ge=t(ee,2);it(Ge,{title:"Advanced Filters",defaultOpen:H,className:"bg-transparent shadow-none p-0",contentClassName:"space-y-2 pt-2",children:(i,l)=>{var N=St(),D=fa(N),V=a(D),n=t(a(V),2),Q=a(n),pe=t(V,2),X=a(pe),Z=a(X),we=t(Z,2),xe=t(a(we),2),Ne=a(xe),ye=t(X,2),ke=a(ye),Ma=t(ke,2),ia=t(a(Ma),2),Sa=a(ia),re=t(pe,2);{var ze=z=>{var la=Mt(),Da=a(la);B(()=>x(Da,e(j))),d(z,la)};h(re,z=>{e(j)&&z(ze)})}var Ca=t(D,2),Te=a(Ca),ra=t(a(Te),2),Be=a(ra);Be.value=Be.__value="any";var Fe=t(Be);Fe.value=Fe.__value="verified";var Oe=t(Fe);Oe.value=Oe.__value="unverified";var na=t(Te,2),sa=t(a(na),2),ne=a(sa);ne.value=ne.__value="any";var Me=t(ne);Me.value=Me.__value="locked";var Re=t(Me);Re.value=Re.__value="unlocked";var ja=t(na,2),oa=t(a(ja),2),Se=a(oa);Se.value=Se.__value="any";var Ae=t(Se);Ae.value=Ae.__value="day";var fe=t(Ae);fe.value=fe.__value="night";var Ue=t(fe);Ue.value=Ue.__value="sunrise";var Ee=t(Ue);Ee.value=Ee.__value="sunset",B(()=>{x(Q,`${f.min??""}% - ${f.max??""}%`),b(Z,"aria-valuenow",f.min),b(Z,"aria-valuetext",`${f.min??""}%`),x(Ne,`${f.min??""}%`),b(ke,"aria-valuenow",f.max),b(ke,"aria-valuetext",`${f.max??""}%`),x(Sa,`${f.max??""}%`)}),Pe(Z,()=>f.min,z=>f.min=z),Pe(ke,()=>f.max,z=>f.max=z),Ra(ra,()=>e(T),z=>s(T,z)),Ra(sa,()=>e(P),z=>s(P,z)),Ra(oa,()=>e(S),z=>s(S,z)),d(i,N)},$$slots:{default:!0}});var Ke=t(Ge,2),Ye=a(Ke);Ye.__click=[xt,v,M,f,T,P,S,p,R,W,y];var $e=t(Ye,2),ga=a($e);{var ea=i=>{var l=Ct();d(i,l)},ba=i=>{var l=jt();d(i,l)};h(ga,i=>{e(w)?i(ea):i(ba,!1)})}var wa=t(U,2),xa=a(wa),De=a(xa),ya=t(a(De),2);{var ka=i=>{var l=Tt(),N=a(l),D=a(N),V=t(N,2),n=t(a(V),2),Q=a(n),pe=a(Q);pe.__click=[Dt,o];var X=t(Q,2),Z=a(X);Z.__click=[qt,o];var we=t(X,2),xe=a(we);xe.__click=[Nt,o];var Ne=t(we,2),ye=a(Ne);ye.__click=[zt,o],B(()=>x(D,`${e(oe)??""} result${e(oe)!==1?"s":""}`)),d(i,l)};h(ya,i=>{e(p)&&i(ka)})}var aa=t(De,2);{var L=i=>{var l=Bt(),N=t(a(l),2),D=a(N);B(()=>x(D,e(W))),d(i,l)};h(aa,i=>{e(W)&&i(L)})}var J=t(aa,2);{var ue=i=>{var l=Ft();d(i,l)};h(J,i=>{e(p)||i(ue)})}var ie=t(J,2);{var qe=i=>{var l=Ot();d(i,l)};h(ie,i=>{e(w)&&e(p)&&i(qe)})}var ta=t(ie,2);{var Ia=i=>{var l=Wt(),N=a(l),D=t(a(N));et(D,23,()=>e(R),V=>V.id,(V,n,Q)=>{var pe=Ht(),X=fa(pe),Z=a(X),we=a(Z),xe=t(Z),Ne=a(xe),ye=a(Ne);ct(ye,{get timeOfDay(){return e(n).timeOfDay},className:"mr-1"});var ke=t(ye,2),Ma=a(ke),ia=t(xe),Sa=a(ia),re=a(Sa);re.__click=[Rt,u,n],re.__keydown=[At,u,n];var ze=a(re),Ca=t(re,2),Te=a(Ca),ra=a(Te),Be=t(Te,2),Fe=a(Be),Oe=t(ia),na=a(Oe),sa=a(na),ne=a(sa),Me=a(ne);let Re;var ja=t(ne,2),oa=a(ja),Se=t(Oe),Ae=a(Se),fe=a(Ae),Ue=a(fe),Ee=t(fe,2),z=a(Ee),la=t(Se),Da=a(la),da=a(Da);da.__click=[Ut];var qa=t(da,2);qa.__click=[Et,n];var Ce=t(qa,2);Ce.__click=[Lt,u,n];var Ja=a(Ce);let La;var Qa=t(X,2);{var Xa=me=>{var G=Pt(),Na=a(G),va=a(Na),za=a(va),ca=a(za),Ta=a(ca);wt(Ta,{get detectionId(){return e(n).id}});var ua=t(ca,2),se=a(ua);se.__click=[Vt,u,n],se.__keydown=[It,u,n];var Le=a(se),Ba=t(ua,2),Za=t(a(Ba),2);Ga(Za,{get audioUrl(){return`/api/v2/audio/${e(n).id??""}`},get spectrogramUrl(){return`/api/v2/spectrogram/${e(n).id??""}?width=400`},get detectionId(){return e(n).id},width:400,height:200,showDownload:!0,showSpectrogram:!0}),B((Fa,Ve)=>{b(G,"id",`expanded-row-${e(n).id??""}`),Y(va,1,`p-4 ${e(Q)%2===0?"bg-base-100":"bg-base-200"}`),b(se,"aria-label",`Collapse details for ${e(n).commonName||"Unknown species"}`),b(se,"aria-expanded",Fa),b(se,"aria-controls",`expanded-row-${e(n).id??""}`),b(Le,"src",`/api/v2/media/species-image?name=${Ve??""}`),b(Le,"alt",e(n).commonName||"Unknown species")},[()=>g(e(n).id),()=>encodeURIComponent(e(n).scientificName)]),I("error",Le,Fa=>{const Ve=Fa.target;Ve&&(Ve.src="/assets/images/bird-placeholder.svg",Ve.classList.add("p-2"))}),d(me,G)};h(Qa,me=>{g(e(n).id)&&me(Xa)})}B((me,G,Na,va,za,ca,Ta,ua,se,Le,Ba)=>{Y(X,1,pa(e(Q)%2===0?"bg-base-100":"bg-base-200")),x(we,me),x(Ma,e(n).timeOfDay||"Unknown"),b(re,"aria-label",`${G??""} details for ${e(n).commonName||"Unknown species"}`),b(re,"aria-expanded",Na),b(ze,"src",`/api/v2/media/species-image?name=${va??""}`),b(ze,"alt",e(n).commonName||"Unknown species"),x(ra,e(n).commonName||"Unknown"),x(Fe,e(n).scientificName||""),b(ne,"aria-valuenow",za),b(ne,"aria-valuetext",`${ca??""}%`),Y(Me,1,`h-full ${e(n).confidence>=.8?"bg-success":e(n).confidence>=.4?"bg-warning":"bg-error"}`),Re=tt(Me,"",Re,Ta),x(oa,`${ua??""}%`),Y(fe,1,`status-badge ${e(n).verified==="correct"?"correct":e(n).verified==="false_positive"?"false":"unverified"}`,"svelte-1mlqqt2"),x(Ue,e(n).verified==="correct"?"Verified":e(n).verified==="false_positive"?"False":"Unverified"),Y(Ee,1,`status-badge ${e(n).locked?"locked":"unverified"}`,"svelte-1mlqqt2"),x(z,e(n).locked?"Locked":"Unlocked"),da.disabled=!e(n).hasAudio,b(da,"aria-label",`Play audio for ${e(n).commonName||"Unknown species"}`),b(qa,"aria-label",`View details for ${e(n).commonName||"Unknown species"}`),b(Ce,"data-id",e(n).id),b(Ce,"aria-label",`${se??""} details for ${e(n).commonName||"Unknown species"}`),b(Ce,"aria-expanded",Le),b(Ce,"aria-controls",`expanded-row-${e(n).id??""}`),La=Y(Ja,0,"h-4 w-4",null,La,Ba)},[()=>$(e(n).timestamp),()=>g(e(n).id)?"Collapse":"Expand",()=>g(e(n).id),()=>encodeURIComponent(e(n).scientificName),()=>Math.round(e(n).confidence*100),()=>Math.round(e(n).confidence*100),()=>({width:`${e(n).confidence*100}%`}),()=>Math.round(e(n).confidence*100),()=>g(e(n).id)?"Collapse":"Expand",()=>g(e(n).id),()=>({"rotate-180":g(e(n).id)})]),I("error",ze,me=>{const G=me.target;G&&(G.src="/assets/images/bird-placeholder.svg",G.classList.add("p-2"))}),d(V,pe)}),d(i,l)};h(ta,i=>{e(p)&&!e(w)&&e(R).length>0&&i(Ia)})}var Ea=t(ta,2);{var Pa=i=>{var l=Jt();d(i,l)};h(Ea,i=>{e(p)&&!e(w)&&e(R).length===0&&!e(W)&&i(Pa)})}var Ha=t(Ea,2);{var Wa=i=>{var l=Zt(),N=a(l),D=a(N);D.__click=[Qt,_e,q];var V=t(D,2),n=a(V),Q=t(V,2);Q.__click=[Xt,_e,q],B(()=>{D.disabled=e(q)<=1,x(n,`Page ${e(q)??""} of ${e(O)??""}`),Q.disabled=e(q)>=e(O)}),d(i,l)};h(Ha,i=>{e(p)&&!e(w)&&e(O)>1&&i(Wa)})}B(()=>$e.disabled=e(w)),I("submit",A,i=>{i.preventDefault(),_(1)}),I("mouseenter",ge,()=>s(C,"species")),I("mouseleave",ge,()=>s(C,null)),I("focus",ge,()=>s(C,"species")),I("blur",ge,()=>s(C,null)),Pe(Je,()=>e(v),i=>s(v,i)),I("mouseenter",be,()=>s(C,"dateRange")),I("mouseleave",be,()=>s(C,null)),I("focus",be,()=>s(C,"dateRange")),I("blur",be,()=>s(C,null)),Pe(Xe,()=>M.start,i=>M.start=i),Pe(Ze,()=>M.end,i=>M.end=i),d(c,he),Ua()}at(["click","keydown"]);export{ai as default};
