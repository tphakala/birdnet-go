{{define "textField"}}

<!-- Text input field -->
<div class="form-control relative" x-data="{ 
    showTooltip: null,
    touched: false,
    fieldId: {{if .dynamicId}}'{{.id}}_' + index{{else}}'{{.id}}'{{end}},
    validInput() {
        return this.$refs.input ? this.$refs.input.validity.valid : true;
    }
}">

    {{if .label}}
    <!-- Label -->
    <label class="label justify-start" :for="fieldId">
        <span class="label-text capitalize">{{.label}}</span>
        <span class="help-icon" @mouseenter="showTooltip = fieldId"
            @mouseleave="showTooltip = null">â“˜</span>
    </label>
    {{end}}

    <!-- Input field -->
    <input type="{{with .type}}{{.}}{{else}}text{{end}}" 
        :id="fieldId"
        name="{{.name}}"
        x-model="{{.model}}"
        placeholder="{{with .placeholder}}{{.}}{{end}}"
        class="input input-sm input-bordered {{.class}}"
        :class="{ 'invalid': touched && !validInput() }"
        x-ref="input"
        {{if .disabled}}x-bind:disabled="{{.disabled}}"{{end}}
        {{if .pattern}}
            pattern="{{.pattern}}"
            @blur="touched = true"
            @invalid="touched = true"
            @input="touched = false"
            required
        {{end}}
        maxlength="255"
        aria-required="{{if .pattern}}true{{else}}false{{end}}"
        aria-invalid="touched && !validInput()"
        :aria-describedby="fieldId + '-error ' + fieldId + '-tooltip'">

    <!-- Validation messages -->
    <span class="text-sm text-red-500"
        :id="fieldId + '-error'"
        role="alert"
        aria-live="polite"
        x-show="touched && !validInput()"
        x-cloak>
        {{with .validationMessage}}
        {{.}}
        {{else}}
        Please enter a valid {{$.label}}
        {{end}}
    </span>

    <!-- Tooltip -->
    <div x-show="showTooltip === fieldId"
        :id="fieldId + '-tooltip'"
        role="tooltip"
        aria-hidden="true"
        x-cloak
        class="tooltip">
        {{.tooltip}}
    </div>
</div>
{{end}}